# Webカメラで撮影をするプログラムを書いてみよう

Webカメラで周りを撮影するプログラム…と聞くとなんだか難しそうですが，OpenCVを使うととても簡単にプログラムを作ることが出来ます．

http://opencv.jp/opencv-2svn/cpp/reading_and_writing_images_and_video.html

手順としては，
* Webカメラへのアクセス
* Webカメラから取り込む映像を表示するためのウィンドウの生成
* 生成したウィンドウの中に映像を描画
* 全ての処理が終了したらデバイス・メモリの解放

といった感じです．早速実装していきましょう．

## Webカメラへのアクセス

みなさんの手持ちのPCには，インカメラが付いているでしょうか?それともカメラは何も付いていないでしょうか．

インカメラが付いているタイプのものは，自動でインカメラを使うようにOpenCV側がなんとかしてくれます．

インカメラがついていないPCを使っている人は，USBカメラを繋げて下さい．USBカメラが認識されれば，こちらもOpenCVが良きに計らってくれます．

main関数の中に，以下のコードを追加して下さい．

```C++
cv::VideoCapture capture(0);
// カメラが使えない場合はプログラムを止める
if(!capture.isOpened())
    return -1
```

OpenCVには，VideoCaptureというWebカメラを容易に扱えることのできるクラス(※)が用意されています．

VideoCapture capture(0)と書けば，コンピュータがデフォルトで指定しているカメラデバイスにアクセスしてくれます．このときアクセスしたカメラに対して，VideoCaptureクラスの中で定義されている関数を使用することができます．

次のif文では，`capture.isOpened()がfalseのとき，プログラムを止める`という処理が書かれています．

否定の条件式はfalseを使うことが多いかもしれませんが、条件の頭に`!`をつけても否定の条件式になります．覚えておいたほうが良いでしょう．

`isOpened()`は，VideoCaptureクラスで定義されている関数であり，USBカメラが認識できているかどうかを判断します．

先ほどカメラにアクセスするためにcaptureを定義しましたので，**captureでアクセスしたカメラに対してisOpened()関数を使いますよ**，という意味でcapture.isOpened()という風に書きます．