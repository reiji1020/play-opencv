# Visual StudioとOpenCVを使う

では，早速Visual Studio 2015を使ってみましょう．

Visual Studio 2015の画面構成は以下のようになります．

![](/img/vsmenu.png)

VisualStudio2013は背景を黒にしたり白にしたりすることが出来ますので，背景が白の状態で立ち上がる人も居るかもしれません．

単純に見た目の問題ですので，同じようなメニューが真ん中に表示されていればOKです．

## 新しいプロジェクトを作成する

新しいプログラムを作る際は，「新しいプロジェクト」ボタンからプロジェクトを作成する所から始めます．

![](/img/vsmenu2.png)

メニューバーから[ファイル]→[新規作成]→[プロジェクト]を選択し，新しいプログラムを作る準備をしましょう．

![](/img/vsmenu3.png)

すると，どのようなプログラムを作るか聞かれます．

1. 左のフレームで「VisualC++」を選びます
2. 「Win32 コンソールアプリケーション」を選びます
3. プロジェクトに名前を付けます(例として「Nagasaki_Color」という名前を付けています)
4. 今回はプロジェクトの保存場所は特に指定しませんが，USBメモリに保存したいなど，別の場所に保存をしたい人は「参照」ボタンを押して，保存したい場所を決めてください．

以下の様なウィンドウが出てきますので，スクリーンショットに従って操作を行ってください．

![](/img/vsmenu4.png)

![](/img/vsmenu5.png)

以上の動作を完了すると，プロジェクトを作ることが出来ます．

## OpenCVを使えるようにする

Visual StudioでOpenCVを使うためには，OpenCVのソースコードがあるディレクトリの場所を設定します．

![](/img/vsopen.png)

[プロジェクト]→[プロパティ]を選択します．

すると，以下のようなウィンドウが開きます．

![](/img/vsopen2.png)

[構成プロパティ]の中にC/C＋＋という項目があります．その左の▼をクリックし，ツリーを展開してください．

リストの中に[全般]というメニューがあるので，これをクリックすると，図の右のような項目が表示されます．この項目の中で，[追加のインクルードディレクトリ]という項目を編集していきます．

右の▼をクリックし，<編集…>をクリックすると，以下の様なウィンドウが新しく開きます．

![](/img/vsopen3.png)

上の空白部分をクリックすると，…というボタンがクリックできるようになります．

ここで，`C:\opencv\build\include`というファイルを選択してください．

![](/img/vsopen5.png)

フォルダを選択できたら，「フォルダーの選択」ボタンを押して終了です．

次に，構成プロパティの中のリンカーという項目をクリックしてください．次はこのリンカーの中の[追加のライブラリディレクトリ]という項目を編集します．

![](/img/vsmenu6.png)

先ほどと同じように，右端の▼をクリックし，<編集…>をクリックします．

同じようなウィンドウが開きますので，ファイルを設定していきましょう．

![](/img/vsmenu7.png)

次は`C:\opencv\build\x86\vc12\lib`というファイルを選択してください．

![](/img/vsopen8.png)

「フォルダーの選択」ボタンをクリックして完了です．

以上でVisual Studio側の設定は終了です．

この動作は毎回行わなければいけないというわけではなく，`新しいプロジェクトを作成する都度行わなければいけない`動作であるため，今回の授業では再度この作業を行うことはありません．

今後VisualStudioとOpenCVを使ってプログラムを作るときには，この動作を行えば良いと覚えておくとよいでしょう．